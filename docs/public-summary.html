<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ariana Huffmyer">
<meta name="author" content="Louis Plough (USDA)">
<meta name="author" content="Steven Roberts">

<title>Resazurin Assay for Oyster Health Assessment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Technical Documentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./public-summary.html" aria-current="page"> 
<span class="menu-text">Public Summary</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/RobertsLab/resazurin-assay-development"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://faculty.washington.edu/sr320/contact.html"> <i class="bi bi-envelope-paper" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Resazurin Assay for Oyster Health Assessment</h1>
<p class="subtitle lead">Measuring Oyster Vitality for Sustainable Aquaculture</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Ariana Huffmyer </p>
             <p>Louis Plough (USDA) </p>
             <p>Steven Roberts </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">August 28, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="what-is-the-resazurin-assay" class="level1">
<h1>What is the Resazurin Assay?</h1>
<p>The resazurin assay is a powerful, non-destructive tool that measures how “metabolically active” or healthy oysters are by detecting their cellular respiration in real-time. Think of it as taking the pulse of an oyster’s metabolism.</p>
<section id="how-it-works" class="level2">
<h2 class="anchored" data-anchor-id="how-it-works">How It Works</h2>
<p>Resazurin is a blue dye that changes color and fluorescence when living cells use oxygen for respiration. When healthy oysters are placed in a solution containing resazurin:</p>
<ol type="1">
<li><strong>Healthy, active oysters</strong> consume more oxygen and cause the dye to change from blue to pink/red, creating a measurable fluorescent signal</li>
<li><strong>Stressed or unhealthy oysters</strong> consume less oxygen, resulting in less color change and lower fluorescence</li>
<li><strong>Dead oysters</strong> produce no signal at all</li>
</ol>
<p>This color change can be measured precisely using laboratory instruments, giving researchers a quantitative measure of oyster health and stress response.</p>
</section>
<section id="why-this-matters-for-aquaculture" class="level2">
<h2 class="anchored" data-anchor-id="why-this-matters-for-aquaculture">Why This Matters for Aquaculture</h2>
<p>Oyster farming is a critical industry worth billions of dollars globally, but farmers face increasing challenges from:</p>
<ul>
<li><strong>Climate change</strong> and rising ocean temperatures</li>
<li><strong>Disease outbreaks</strong> that can devastate farms</li>
<li><strong>Ocean acidification</strong> affecting shell formation</li>
<li><strong>Unpredictable mortality events</strong> causing economic losses</li>
</ul>
<section id="current-challenges-in-oyster-farming" class="level3">
<h3 class="anchored" data-anchor-id="current-challenges-in-oyster-farming">Current Challenges in Oyster Farming</h3>
<p>Traditional methods for assessing oyster health often involve:<br>
- Waiting to see mortality (too late for intervention)<br>
- Destructive testing that kills the animals being assessed<br>
- Time-consuming methods that can’t keep pace with changing conditions<br>
- Inability to predict which oysters will survive stress</p>
</section>
<section id="how-resazurin-assays-help" class="level3">
<h3 class="anchored" data-anchor-id="how-resazurin-assays-help">How Resazurin Assays Help</h3>
<p>The resazurin assay offers exciting potential for oyster farmers and researchers to use a <strong>predictive tool</strong> to:</p>
<ul>
<li><strong>Identify resilient oysters</strong> before breeding programs</li>
<li><strong>Detect stress early</strong> before visible signs of illness</li>
<li><strong>Screen large numbers</strong> of oysters quickly and cost-effectively</li>
<li><strong>Test environmental conditions</strong> to optimize farm management</li>
<li><strong>Select for heat tolerance</strong> as ocean temperatures rise</li>
</ul>
</section>
</section>
</section>
<section id="key-findings-from-our-research" class="level1">
<h1>Key Findings from Our Research</h1>
<p>Our research team has conducted four major studies testing the resazurin assay across different oyster life stages and conditions. This assay is currently under development. Check back regularly to view updates as we continue to test and improve the assay! Note that our work has been primarily conducted in the laboratory and we are currently conducting field tests to apply the resazurin assay to real-world oyster monitoring!</p>
<section id="heat-tolerance-screening" class="level2">
<h2 class="anchored" data-anchor-id="heat-tolerance-screening">1. Heat Tolerance Screening</h2>
<p><strong>What we tested:</strong> 500 young oysters exposed to various environmental conditions, then tested for heat tolerance</p>
<p><strong>Key discoveries:</strong><br>
- Oysters with <strong>higher metabolic activity</strong> under heat stress had <strong>lower survival rates</strong><br>
- Oysters showing <strong>metabolic depression</strong> (slowing down) under stress were more likely to survive<br>
- The assay can predict which oysters will survive short-term thermal stress within hours in laboratory testing</p>
<p><strong>Future industry implication:</strong> Potential for farmers can identify heat-tolerant oyster lines for breeding programs, crucial as ocean temperatures continue to rise.</p>
</section>
<section id="early-life-stage-assessments" class="level2">
<h2 class="anchored" data-anchor-id="early-life-stage-assessments">2. Early Life Stage Assessments</h2>
<p><strong>What we tested:</strong> Young oyster spat from different genetic backgrounds exposed to temperature stress</p>
<p><strong>Key discoveries:</strong><br>
- The assay works effectively on very small oysters (as small as 7mm)<br>
- <strong>Genetic background influences</strong> metabolic response to stress<br>
- Different temperatures reveal different patterns of metabolic performance<br>
- Parental conditioning affects offspring stress resistance</p>
<p><strong>Future industry implication:</strong> Selective breeding and selection based on metabolic traits can start at the earliest life stages, and hatcheries can optimize conditions based on genetic lines.</p>
</section>
<section id="genetic-variation-assessment" class="level2">
<h2 class="anchored" data-anchor-id="genetic-variation-assessment">3. Genetic Variation Assessment</h2>
<p><strong>What we tested:</strong> Metablic responses in five distinct oyster family lines from USDA breeding programs</p>
<p><strong>Key discoveries:</strong><br>
- <strong>Significant genetic differences</strong> in metabolic rates between families<br>
- Some family lines consistently outperform others under stress<br>
- Metabolic traits appear to be heritable and distinct between families</p>
<p><strong>Future industry implication:</strong> Breeding programs can select for metabolically robust lines, creating more resilient oyster stocks for farmers.</p>
</section>
<section id="breeding-program-scale-assessment-vims-abc-trials" class="level2">
<h2 class="anchored" data-anchor-id="breeding-program-scale-assessment-vims-abc-trials">4. Breeding Program Scale Assessment (VIMS / ABC Trials)</h2>
<p><strong>What we tested:</strong> Resazurin metabolic assays tested across 50 oyster families, ploidy types (diploid vs triploid), and environmental stress conditions to predict performance traits at the Virginia Institute of Marine Science.</p>
<p><strong>Key discoveries:</strong><br>
- Metabolic activity <strong>significantly correlates with predicted survival in low-salinity environments</strong>.<br>
- Acute stress response (within first hour) correlates with long-term predicted performance traits<br>
- Distinct metabolic profiles between <strong>triploid and diploid oysters</strong> with higher metabolic rates in diploid oysters<br>
- Family-level genetic variation supporting selective breeding applications<br>
- In progress field tracking and assessment will allow us to determine how metabolic response relates to field performance</p>
<p><strong>Future industry implication:</strong> The research enables accelerated assessment of breeding programs, potential reductions in environmental stress mortality due to family selection, and cost-effective screening ($2-5 per assay vs $0.50-2.00 per oyster mortality cost).</p>
</section>
</section>
<section id="practical-applications-in-aquaculture" class="level1">
<h1>Practical Applications in Aquaculture</h1>
<section id="for-oyster-farmers" class="level2">
<h2 class="anchored" data-anchor-id="for-oyster-farmers">For Oyster Farmers</h2>
<section id="breeding-stock-selection" class="level3">
<h3 class="anchored" data-anchor-id="breeding-stock-selection"><strong>Breeding Stock Selection</strong></h3>
<ul>
<li>Test parent oysters before breeding to select for stress tolerance</li>
<li>Identify oysters that maintain stable metabolism under challenging conditions</li>
<li>Reduce mortality in subsequent generations</li>
</ul>
</section>
<section id="environmental-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="environmental-monitoring"><strong>Environmental Monitoring</strong></h3>
<ul>
<li>Test how different temperature conditions affect oyster health</li>
<li>Optimize farm placement and management practices</li>
<li>Predict and prepare for stress events</li>
<li>Monitor health of stocks using rapid assessments</li>
</ul>
</section>
<section id="quality-assessment" class="level3">
<h3 class="anchored" data-anchor-id="quality-assessment"><strong>Quality Assessment</strong></h3>
<ul>
<li>Evaluate oyster health during stress events</li>
<li>Assess the impact of different farming practices on oyster health</li>
<li>Monitor recovery after stress events</li>
</ul>
</section>
</section>
<section id="for-researchers-and-hatcheries" class="level2">
<h2 class="anchored" data-anchor-id="for-researchers-and-hatcheries">For Researchers and Hatcheries</h2>
<section id="breeding-program-optimization" class="level3">
<h3 class="anchored" data-anchor-id="breeding-program-optimization"><strong>Breeding Program Optimization</strong></h3>
<ul>
<li>Rapidly screen thousands of individuals</li>
<li>Identify metabolic traits linked to survival and desirable traits</li>
<li>Accelerate genetic improvement programs</li>
</ul>
</section>
<section id="environmental-research" class="level3">
<h3 class="anchored" data-anchor-id="environmental-research"><strong>Environmental Research</strong></h3>
<ul>
<li>Study how climate change affects oyster physiology</li>
<li>Test the effectiveness of different mitigation strategies</li>
<li>Understand the mechanisms of stress resistance</li>
</ul>
</section>
</section>
</section>
<section id="schematic-resazurin-assay-applications" class="level1">
<h1>Schematic: Resazurin Assay Applications</h1>
<p>The following diagram illustrates how the resazurin assay can be applied across different sectors of the aquaculture industry:</p>
<pre><code>                     RESAZURIN ASSAY APPLICATIONS
                              │
              ┌───────────────┼───────────────┐
              │               │               │
         HATCHERY       FARM MANAGEMENT    RESEARCH
              │               │               │
    ┌─────────┼─────────┐    │    ┌─────────┼─────────┐
    │         │         │    │    │         │         │
BREEDING  QUALITY   GENETIC │ STOCK     ENVIRONMENT MARKET
SELECTION CONTROL  STUDIES │ SELECTION  MONITORING READINESS
    │         │         │    │    │         │         │
    ▼         ▼         ▼    ▼    ▼         ▼         ▼
Select    Test      Study      Choose    Monitor   Assess
heat-     juvenile  stress     tolerant  farm      oyster
tolerant  health    response   breeding  conditions health
parents             patterns   lines</code></pre>
<p><strong>Detailed Application Flow:</strong><br>
1. <strong>Sample Collection</strong> → Oysters placed in resazurin solution<br>
2. <strong>Stress Application</strong> → Temperature or other stressors applied<br>
3. <strong>Fluorescence Measurement</strong> → Metabolic activity quantified over time<br>
4. <strong>Data Analysis</strong> → Health status and stress tolerance assessed<br>
5. <strong>Decision Making</strong> → Selection, management, or research decisions implemented</p>
<p><strong>Key Measurement Outcomes:</strong><br>
- <strong>High fluorescence</strong> = Active metabolism (may indicate stress response)<br>
- <strong>Moderate fluorescence</strong> = Healthy, stable metabolism<br>
- <strong>Low fluorescence</strong> = Metabolic depression (may indicate survival strategy)<br>
- <strong>No fluorescence</strong> = Non-viable organism</p>
<p><em>For a detailed visual breakdown of applications, see <a href="./figures/resazurin-applications-diagram.html">figures/resazurin-applications-diagram.md</a>.</em></p>
</section>
<section id="current-research-status-and-performance" class="level1">
<h1>Current Research Status and Performance</h1>
<section id="assay-validation" class="level2">
<h2 class="anchored" data-anchor-id="assay-validation">Assay Validation</h2>
<p>✅ <strong>Proven effective</strong> across oyster sizes from 4mm spat/seed to adult oysters<br>
✅ <strong>Temperature range tested</strong> from ambient (20°C) to extreme stress (45°C) ✅ <strong>Sensitive measurement methods</strong> validated fluorescence ✅ <strong>Rapid results</strong> - metabolic assessment within 4-5 hours<br>
✅ <strong>Non-destructive</strong> - oysters can be returned to culture after testing or indiividually tragged and tracked</p>
</section>
<section id="research-contexts" class="level2">
<h2 class="anchored" data-anchor-id="research-contexts">Research Contexts</h2>
<p>The resazurin assay has been successfully applied in:</p>
<ul>
<li><strong>Thermal stress testing</strong> - identifying heat-tolerant oysters</li>
<li><strong>Thermal performance curves</strong> - identifying metabolic optima and tipping points</li>
<li><strong>Genetic screening</strong> - comparing family lines for breeding</li>
<li><strong>Environmental assessment</strong> - testing impacts of different conditions</li>
<li><strong>Mortality prediction</strong> - identifying oysters at risk of short-term mortality</li>
<li><strong>Breeding program optimization</strong> - accelerating genetic improvement</li>
</ul>
</section>
<section id="technical-advantages" class="level2">
<h2 class="anchored" data-anchor-id="technical-advantages">Technical Advantages</h2>
<ul>
<li><strong>High throughput</strong> - can test hundreds to thousands of oysters simultaneously</li>
<li><strong>Cost effective</strong> - minimal reagent costs, but requires access to a fluorescence plate reader</li>
<li><strong>Standardized protocol</strong> - reproducible across different laboratories</li>
<li><strong>Real-time monitoring</strong> - tracks metabolic changes over time</li>
<li><strong>Multi-species potential</strong> - applicable to other shellfish species</li>
</ul>
</section>
</section>
<section id="future-directions" class="level1">
<h1>Future Directions</h1>
<section id="immediate-development-goals" class="level2">
<h2 class="anchored" data-anchor-id="immediate-development-goals">Immediate Development Goals</h2>
<section id="field-application" class="level3">
<h3 class="anchored" data-anchor-id="field-application"><strong>Field Application</strong></h3>
<ul>
<li>Develop portable testing equipment for on-farm use</li>
<li>Create simplified protocols for farmers and hatchery managers</li>
<li>Establish reference ranges for different oyster populations</li>
<li>Track field performance to determine relationship between rapid metabolic assay and real-world performance</li>
</ul>
</section>
<section id="expanded-applications" class="level3">
<h3 class="anchored" data-anchor-id="expanded-applications"><strong>Expanded Applications</strong></h3>
<ul>
<li>Test effectiveness with other shellfish species (mussels, clams, scallops)</li>
<li>Develop protocols for different stress types (salinity, pH, disease)</li>
<li>Integrate with existing aquaculture management systems</li>
</ul>
</section>
</section>
<section id="long-term-vision" class="level2">
<h2 class="anchored" data-anchor-id="long-term-vision">Long-term Vision</h2>
<section id="industry-integration" class="level3">
<h3 class="anchored" data-anchor-id="industry-integration"><strong>Industry Integration</strong></h3>
<ul>
<li><strong>Breeding programs</strong> routinely use metabolic screening</li>
<li><strong>Farmers</strong> have access to stress-tolerance testing</li>
<li><strong>Insurance and certification</strong> programs incorporate metabolic health assessments</li>
<li><strong>Climate adaptation</strong> strategies include metabolic resilience selection</li>
</ul>
</section>
<section id="research-expansion" class="level3">
<h3 class="anchored" data-anchor-id="research-expansion"><strong>Research Expansion</strong></h3>
<ul>
<li><strong>Mechanistic understanding</strong> of metabolic stress responses</li>
<li><strong>Genomic integration</strong> linking metabolic traits to genetic markers</li>
<li><strong>Ecosystem applications</strong> for wild oyster restoration projects</li>
<li><strong>Climate change mitigation</strong> through enhanced oyster resilience</li>
</ul>
</section>
<section id="technology-development" class="level3">
<h3 class="anchored" data-anchor-id="technology-development"><strong>Technology Development</strong></h3>
<ul>
<li><strong>Automated systems</strong> for high-throughput screening</li>
<li><strong>Real-time monitoring</strong> in farm environments</li>
<li><strong>Predictive models</strong> combining metabolic data with environmental conditions</li>
<li><strong>Mobile applications</strong> for data collection and analysis</li>
</ul>
</section>
</section>
<section id="expected-industry-impact" class="level2">
<h2 class="anchored" data-anchor-id="expected-industry-impact">Expected Industry Impact</h2>
<p><strong>Short-term (1-3 years):</strong> - Research institutions adopt standardized protocols - Pilot programs in commercial hatcheries begin - Initial breeding program implementations</p>
<p><strong>Medium-term (3-7 years):</strong> - Commercial availability of testing services - Integration into major oyster breeding programs - Regulatory acceptance for aquaculture applications</p>
<p><strong>Long-term (7+ years):</strong> - Industry-standard tool for oyster health assessment - Improved oyster survival rates and farm profitability - Enhanced climate resilience of cultured oyster populations</p>
</section>
</section>
<section id="why-this-research-matters" class="level1">
<h1>Why This Research Matters</h1>
<p>As our oceans continue to change due to climate change, the need for resilient aquaculture becomes increasingly critical. Oysters are not just a valuable food source - they also provide essential ecosystem services including water filtration and coastal protection.</p>
<p>The resazurin assay represents a significant step forward in our ability to:</p>
<ul>
<li><strong>Protect aquaculture investments</strong> by selecting resilient stock</li>
<li><strong>Improve food security</strong> through more reliable oyster production</li>
<li><strong>Support coastal communities</strong> dependent on shellfish farming</li>
<li><strong>Enhance ecosystem restoration</strong> with stress-tolerant oyster populations</li>
</ul>
<p>This research bridges the gap between laboratory science and practical aquaculture applications, providing tools that can make a real difference in the sustainability and profitability of oyster farming in a changing world.</p>
<hr>
<p><em>For technical details and protocols, visit our <a href="./index.html">main research page</a> or explore our <a href="https://github.com/RobertsLab/resazurin-assay-development">GitHub repository</a>.</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>